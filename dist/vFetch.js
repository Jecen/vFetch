!function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=1)}([function(e,t){e.exports="object"==typeof self?self.FormData:window.FormData},function(e,t,o){"use strict";o.r(t),function(e){var t=o(0),n=o.n(t);class r{constructor(e){const{message:t,code:o,httpStatus:n=200}=e;this.httpStatus=n,this.message=t,this.code=o,this.prototype=Object.create(Error.prototype),this.prototype.constructor=this}}r.ERROR_CODE={HTTP_STATUS_ERROR:"HTTP_STATUS_ERROR",REQUEST_TIMEOUT:"REQUEST_TIMEOUT",TOKEN_EXPIRE:"TOKEN_EXPIRE",RESPONSE_PARSING_FAILED:"RESPONSE_PARSING_FAILED"};class s{constructor(e){const{conf:t={baseUrl:"",headers:{}},before:o=[],after:n=[],error:r=null,timeout:s=5e3}=e;this.config=t,this.beforeHooks=o,this.afterHooks=n,this.errorHook=r,this.timeout=s}_getQueryData(t,o="string"){if(!t)return null;const r=[],s=e.exports?new n.a:new FormData,i=Object.entries(t);return i.length>0&&i.forEach(e=>{const[t,o]=e;0!==o.length&&o&&(r.push(`${t}=${encodeURIComponent(o)}`),s.append(t,o))}),"string"===o?r.join("&"):s}_getRequestOptions({opt:e,method:t,params:o}){const{type:n}=e,r={method:t,...e},s=Object.assign({},this.config.headers,e.headers);if("upload"===n&&(s["Content-Type"]=void 0,delete s["Content-Type"]),r.headers=s,"[object FormData]"===Object.prototype.toString.call(o))return r.body=o,r;if("GET"!==t&&"OPTION"!==t&&o){r.headers["Content-Type"]||"upload"===n||(r.headers["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8");const e=r.headers["Content-Type"]||"";e.indexOf("application/json")>-1?r.body="string"==typeof o?o:JSON.stringify(o):e.indexOf("application/x-www-form-urlencoded")>-1?r.body=Object.keys(o).map(e=>`${encodeURIComponent(e)}=${encodeURIComponent(o[e])}`).join("&"):(e.indexOf("multipart/form-data")>-1||!e)&&(r.body=this._getQueryData(o,"formData"))}return Object.assign({},this.config,r)}_checkResponse(e,t){return e}_initUrl(e,t,o,n){const r=-1!==e.indexOf("://")?"FULL":"PATH";let s=null,i=this.config.baseUrl||"";if(o&&o.baseUrl){const{baseUrl:e}=i;i=e}let c="FULL"!==r?i+e:e;return"GET"!==t&&"DELETE"!==t&&"OPTION"!==t||(s=this._getQueryData(n))&&s.length&&(c+=`?${s}`),c}_sendRequestWithTimeOut(e,t){return Promise.race([e,new Promise((e,o)=>{setTimeout(()=>{const e=new r({message:"请求超时",code:r.ERROR_CODE.REQUEST_TIMEOUT,httpStatus:901});o(e),t(e)},this.timeout)})])}_getApiPromise(e,t,o,n,s,i){const{type:c}=o;return new Promise((a,u)=>e(t,o).then(e=>this._checkResponse("download"===c?e.blob():e.json(),u)).catch(()=>{const e=new r({message:"请求失败，请检查网络情况，并联系管理员。",code:r.ERROR_CODE.RESPONSE_PARSING_FAILED,httpStatus:null});u(e),n(e)}).then(e=>{const t="download"===c?{code:606,data:e,success:!0,msg:"操作成功"}:e;this.afterHooks.length>0&&this.afterHooks.forEach(e=>{if(!s()){const o=e(t);o instanceof r&&(u(o),n(o))}}),i(),a(t)}))}_sendRequest(e,t,o="GET",n={},r={}){const s=this._initUrl(t,o,r,n),i=this._getRequestOptions({opt:r,method:o,params:n}),[c,a]=this.beforeHooks.reduce(([e,t],o)=>o([e,t])||[e,t],[s,i]);let u=!1;const l=e=>{!u&&this.errorHook&&this.errorHook(e,s),u=!0},p=this._getApiPromise(e,c,a,l,()=>u,()=>{u=!0});return this._sendRequestWithTimeOut(p,l)}injectAfter(e){e&&this.afterHooks.push(e)}injectBefore(e){e&&this.beforeHooks.push(e)}setError(e){e&&(this.errorHook=e)}get(e,t,o,n){return this._sendRequest(e,t,"GET",o,n)}post(e,t,o,n){return this._sendRequest(e,t,"POST",o,n)}put(e,t,o,n){return this._sendRequest(e,t,"PUT",o,n)}option(e,t,o,n){return this._sendRequest(e,t,"OPTION",o,n)}delete(e,t,o,n){return this._sendRequest(e,t,"DELETE",o,n)}}function i(e,t){let o=t||fetch;const{allow:n=["get","post","put","delete","option"]}=e,r=new s({...e,isNode:!!t}),i={injectAfter:r.injectAfter.bind(r),injectBefore:r.injectBefore.bind(r),setErrorHook:r.setError.bind(r)};return n.forEach(e=>{i[e]=(async(t,n,s)=>r[e](o,t,n,s))}),i}const c={conf:{credentials:"include",baseUrl:"/api",headers:{Accept:"application/json"}},before:[([e,t])=>{console.log("hook1",e,t)},([e,t])=>{console.log("hook2",e,t)}],after:[e=>{console.log("after hook1",e)}],timeout:5e3};i.HttpError=r,i.HTTP_ERROR_MAP={HTTP_STATUS_ERROR:"服务器未正常响应",REQUEST_TIMEOUT:"请求超时",TOKEN_EXPIRE:"token校验失效",RESPONSE_PARSING_FAILED:"reponse解析出错"},i.httpConfig=c,"object"==typeof exports&&"object"==typeof e?(e.exports=i,e.exports.default=i):(window.VFetch=i,console.log(window,"!!!!",i))}.call(this,o(2)(e))},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}}]);